<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml" >
<head th:include="parts/_head :: head(${title})"/>
</head>
<body style="margin:0;padding: 0">
<div>
    <!--рамка-->
    <svg  height="923.35" width="1434" size="90%" font-style="oblique" font-family="Arial" style="position: absolute">
        <line x1="1" x2="1" y1="1" y2="923.35" stroke="black" stroke-width="2"></line>
        <line x1="1" x2="1433.35" y1="1" y2="1" stroke="black" stroke-width="2"></line>
        <line x1="1433.35" x2="1433.35" y1="1" y2="923.35" stroke="black" stroke-width="2"></line>
        <line x1="1" x2="1433.35" y1="923.35" y2="923.35" stroke="black" stroke-width="2"></line>
        <!-- верт линии-->
        <line x1="512.9" x2="512.9" y1="724.8" y2="925.05" stroke="black" stroke-width="1.5"></line>
        <line x1="547.9" x2="547.9" y1="724.8" y2="799.8" stroke="black" ></line>
        <line x1="597.9" x2="597.9" y1="724.8" y2="925.05" stroke="black" stroke-width="1.5"></line>
        <line x1="712.9" x2="712.9" y1="724.8" y2="925.05" stroke="black" stroke-width="1.5"></line>
        <line x1="787.9" x2="787.9" y1="724.8" y2="925.05" stroke="black" stroke-width="1.5"></line>
        <line x1="837.9" x2="837.9" y1="724.8" y2="925.05" stroke="black" stroke-width="1.5"></line>
        <line x1="1187.9" x2="1187.9" y1="800" y2="925.05" stroke="black" stroke-width="1.5"></line>
        <line x1="1262.9" x2="1262.9" y1="800" y2="849.9" stroke="black" stroke-width="1.5"></line>
        <line x1="1337.9" x2="1337.9" y1="800" y2="849.9" stroke="black" stroke-width="1.5"></line>
        <line x1="1212.9" x2="1212.9" y1="824.8" y2="849.9" stroke="black" ></line>
        <line x1="1237.9" x2="1237.9" y1="824.8" y2="849.9" stroke="black" ></line>
        <!--гориз линии-->
        <line x1="512.9" x2="837.9" y1="749.8" y2="749.8" stroke="black"></line>
        <line x1="512.9" x2="837.9" y1="774.8" y2="774.8" stroke="black"></line>
        <line x1="512.9" x2="837.9" y1="799.8" y2="799.8" stroke="black"></line>
        <line x1="512.9" x2="837.9" y1="824.8" y2="824.8" stroke="black"></line>
        <line x1="512.9" x2="837.9" y1="849.8" y2="849.8" stroke="black"></line>
        <line x1="512.9" x2="837.9" y1="874.8" y2="874.8" stroke="black"></line>
        <line x1="512.9" x2="837.9" y1="899.8" y2="899.8" stroke="black"></line>
        <line x1="1187.9" x2="1437.9" y1="824.8" y2="824.8" stroke="black"></line>
        <line x1="1187.9" x2="1437.9" y1="849.9" y2="849.9" stroke="black"></line>
        <line x1="512.9" x2="1437.9" y1="724.8" y2="724.8" stroke="black" stroke-width="1.5"></line>
        <line x1="837.9" x2="1437.9" y1="799.8" y2="799.8" stroke="black"></line>

        <text  x="515" y="820" font-size="95%">Разраб.</text>
        <text x="615" y="820" font-size="95%" th:text="${building.nameCreate}"></text>

        <text x="515" y="843" font-size="95%">Пров.</text>
        <text x="615" y="843" font-size="95%" th:text="${building.nameControl}"></text>

        <text x="515" y="893" font-size="95%">Н контр.</text>
        <text x="515" y="918" font-size="95%">Утв.</text>

        <text x="515" y="795" font-size="95%">Изм.</text>
        <text x="555" y="795" font-size="95%">Лист</text>
        <text x="615" y="795" font-size="95%">№ докум.</text>
        <text x="730" y="795" font-size="95%">Подп.</text>
        <text x="797" y="795" font-size="95%">Дата</text>
        <text x="792" y="820" font-size="75%"th:text="${#temporals.format(building.date,'dd.MM.yy')}"></text>

        <text x="1205" y="820" font-size="95%">Стадия</text>
        <text x="1222" y="843" font-size="95%">Р</text>
        <text x="1285" y="820" font-size="95%">Лист</text>
        <text x="1295" y="843" font-size="95%" th:text="${number}"></text>
        <text x="1363" y="820" font-size="95%">Листов</text>
        <text x="1380" y="843" font-size="95%" th:text="${count}"></text>

        <text x="850" y="770" font-size="120%" th:text="${building.project}"></text>
        <text x="1220" y="900" font-size="120%" th:text="${account.company}"></text>
        <text x="850" y="820" font-size="120%" id="building" class="d-none" th:text="${building.name}"></text>
        <text x="850" y="820" font-size="120%" id="building-result"></text>

    </svg>

    <div class="row">
        <div class="col-1" style="width: 180px; padding-right: 0;padding-left: 20px;">
            <!--таблица-->
            <svg height="567.5" width="161">
                <text x="18" y="45" font-size="75%">Данные питающей сети</text>
                <text x="11" y="140" font-size="75%" style="writing-mode: vertical-lr">Распределительный пункт</text>
                <text x="45" y="120" font-size="75%" style="writing-mode: vertical-lr">Ааппарат</text>
                <text x="30" y="130" font-size="75%" style="writing-mode: vertical-lr">ввода</text>
                <text x="60" y="130" font-size="75%">Тип(Iном), А</text>
                <text x="60" y="145" font-size="75%">Расцепитель,</text>
                <text x="60" y="160" font-size="75%">Расчетный ток</text>
                <text x="45" y="240" font-size="75%" style="writing-mode: vertical-lr">Ааппарат</text>
                <text x="30" y="220" font-size="75%" style="writing-mode: vertical-lr">отходящейи линии</text>
                <text x="60" y="240" font-size="75%">Тип(Iном), А</text>
                <text x="60" y="255" font-size="75%">Расцепитель</text>
                <text x="45" y="335" font-size="75%" style="writing-mode: vertical-lr">Марка и сечение</text>
                <text x="30" y="349" font-size="75%" style="writing-mode: vertical-lr">проводника</text>
                <text x="75" y="340" font-size="75%" style="writing-mode: vertical-lr">Длина участка</text>
                <text x="30" y="450" font-size="75%" style="writing-mode: vertical-lr">Электроприемник</text>

                <text x="60" y="445" font-size="70%">Номер по плану</text>
                <text x="60" y="465" font-size="70%">Мощьность, кВт</text>
                <text x="60" y="485" font-size="70%">Ток, А / Кисп.</text>
                <text x="60" y="520" font-size="70%">Наименование</text>
                <text x="60" y="537" font-size="70%">потребителя</text>

                <line x1="160.45" x2="160.45" y1="566.5" y2="1.4" stroke="black"></line>
                <line x1="1.4" x2="160.45" y1="1.4" y2="1.4" stroke="black"></line>
                <line x1="1.4" x2="1.4" y1="566.5" y2="1.4" stroke="black"></line>
                <line x1="18" x2="18" y1="332.6" y2="84.2" stroke="black"></line>
                <line x1="1.4" x2="160.45" y1="84.2" y2="84.2" stroke="black"></line>
                <line x1="19.4" x2="160.45" y1="208.4" y2="208.4" stroke="black"></line>
                <line x1="54.45" x2="54.45" y1="566.5" y2="84.2" stroke="black"></line>
                <line x1="1.4" x2="160.45" y1="332.65" y2="332.65" stroke="black"></line>
                <line x1="1.4" x2="160.25" y1="430.35" y2="430.35" stroke="black"></line>
                <line x1="54.45" x2="160.25" y1="451" y2="451" stroke="black"></line>
                <line x1="54.45" x2="160.4" y1="471.05" y2="471.05" stroke="black"></line>
                <line x1="54.45" x2="160.4" y1="491.4" y2="491.4" stroke="black"></line>
                <line x1="1.4" x2="160.45" y1="566.5" y2="566.5" stroke="black"></line>
            </svg>
        </div>
        <div class="col" style="padding: 0;width: 100%">
            <!--ввод-->
            <svg height="230.5" width="346.5" style="width: 100%;margin-bottom: -22px;margin-top: -11.8px">
                <!--текст-->
                <text x="20" y="40" font-size="110%" id="nameShield" th:text="${shield.nameShield}"></text>
                <text x="40" y="145" font-size="60%" th:text="${shield.nameProtect}"></text>
                <text x="40" y="160" font-size="60%"
                      th:text="${shield.descriptionProtect}+''+${shield.currentProtect}"></text>
                <text th:if="${shield.cable}!=null" x="170" y="55" font-size="60%" th:text="${shield.cable}"></text>
                <text th:if="${shield.length}!=null" x="170" y="77" font-size="60%" th:text="'L='+${shield.length}"></text>
                <text th:if="${shield.ratedCurrent}!=null" x="250" y="120" font-size="80%" th:text="'Iрасч. = '+${shield.ratedCurrent}+'А'"></text>
                <text th:if="${shield.ratedPower}!=null" x="250" y="140" font-size="80%" th:text="'Pрасч. = '+${shield.ratedPower}+'кВт'"></text>
                <!--фаза-->
                <circle r="3" cx="102.65" cy="209.5"/>
                <line x1="102.65" x2="346.5" y1="63.35" y2="63.35" stroke="black"></line>
                <line x1="102.65" x2="102.65" y1="63.35" y2="132.9" stroke="black"></line>
                <line x1="92" x2="102.6" y1="133.25" y2="161.85" stroke="black"></line>
                <line x1="102.65" x2="102.65" y1="161.85" y2="209.5" stroke="black"></line>
                <line x1="89.4" x2="95.45" y1="144.55" y2="142.35" stroke="black"></line>
                <line x1="89.4" x2="93.7" y1="144.55" y2="156.4" stroke="black"></line>
                <line x1="93.7" x2="99.85" y1="156.4" y2="154.2" stroke="black"></line>
                <!--ноль-->
                <line x1="102.65" x2="119.15" y1="107.45" y2="123.15" stroke="black"></line>
                <circle r="3" cx="119.1" cy="217.7"/>
                <!--без разрыва-->
                 <line th:if="${shield.phase}%2!=0"  x1="119.1" x2="119.1" y1="123.15" y2="217.7" stroke="black"></line>
                <!--ноль с разрывом-->
                <line th:if="${shield.phase}%2==0" x1="119.1" x2="119.1" y1="123.15" y2="132.9" stroke="black"></line>
                <line th:if="${shield.phase}%2==0" x1="108.15" x2="119.1" y1="132.9" y2="161.85" stroke="black"></line>
                <line th:if="${shield.phase}%2==0" x1="96.6" x2="112.85" y1="145.2" y2="145.2" stroke="black"></line>
                <line th:if="${shield.phase}%2==0" x1="98.95" x2="115.35" y1="151.75" y2="151.75" stroke="black"></line>
                <line th:if="${shield.phase}%2==0" x1="119.1" x2="119.1" y1="161.85" y2="217.75" stroke="black"></line>
                <!--УЗО-->
                <line th:if="${shield.RCDCurrent}!=null" x1="85" x2="92" y1="150.5" y2="150.5" stroke="black"></line>
                <line th:if="${shield.RCDCurrent}!=null" x1="85" x2="85" y1="175" y2="150.5" stroke="black"></line>
                <line th:if="${shield.RCDCurrent}!=null" x1="85" x2="94" y1="175" y2="175" stroke="black"></line>
                <ellipse th:if="${shield.RCDCurrent}!=null" rx="16.4" ry="7.55" cx="110" cy="175" stroke="black" fill="none" stroke-width="1"/>

                <!--PE-->
                <circle r="3" cx="134.55" cy="226.5"/>
                <line x1="102.65" x2="134.6" y1="107.45" y2="123.15" stroke="black"></line>
                <line x1="134.55" x2="134.55" y1="123.15" y2="226.5" stroke="black"></line>
                <!--фазы-->
                <line th:if="${shield.phase}>2" x1="99.2" x2="106.15" y1="78.45" y2="71.5" stroke="black"></line>
                <line x1="99.2" x2="106.15" y1="86.15" y2="79.2" stroke="black"></line>
                <line th:if="${shield.phase}>2" x1="99.2" x2="106.15" y1="92.85" y2="85.9" stroke="black"></line>
            </svg>
            <!--группа-->
            <svg height="371.1" width="86.5" th:each=" g,iter : ${groups}">
                <!--        гориз лин-->
                <line x1="0" x2="86.5" y1="3" y2="3" stroke="black" stroke-width="2"></line>
                <line x1="0" x2="86.5" y1="10" y2="10" stroke="black"></line>
                <line x1="0" x2="86.5" y1="17.2" y2="17.2" stroke="black"></line>
                <!--    фаза-->
                <circle r="3" cx="41.4" cy="3.05"/>
                <text x="15" y="60" font-size="60%" style="writing-mode: vertical-lr"
                      th:text="*{g.nameProtect}+', '+*{g.descriptionProtect}+''+*{g.currentProtect}">
                </text>
                <text th:if="*{g.length}!=null" x="30" y="150" font-size="60%" style="writing-mode: vertical-lr"
                      th:text="'L='+*{g.length}"></text>
                <text th:if="*{g.cable}!=''" x="52" y="145" font-size="60%" style="writing-mode: vertical-lr"
                      th:text="*{g.cable}"></text>
                <line x1="41.4" x2="41.4" y1="59.8" y2="3.05" stroke="black"></line>
                <line x1="30.8" x2="41.4" y1="60" y2="88.6" stroke="black"></line>
                <line x1="28.15" x2="34.2" y1="71.3" y2="69.1" stroke="black"></line>
                <line x1="28.15" x2="32.45" y1="71.3" y2="83.15" stroke="black"></line>
                <line x1="32.45" x2="38.6" y1="83.15" y2="80.95" stroke="black"></line>
                <line th:if="*{g.cable}!=''" x1="41.4" x2="41.4" y1="233.95" y2="88.6" stroke="black"></line>
                <line x1="41.4" x2="41.4" y1="135" y2="88.6" stroke="black"></line>

                <!--ноль -->
                <circle r="3" cx="56.5" cy="10.35"/>
                <!--            с разрывом-->
                <line th:if="*{g.phase}%2==0" x1="56.5" x2="56.5" y1="59.9" y2="10.35" stroke="black"></line>
                <line th:if="*{g.phase}%2==0" x1="45.9" x2="56.5" y1="60" y2="88.6" stroke="black"></line>
                <line th:if="*{g.phase}%2==0" x1="56.5" x2="56.5" y1="117.45" y2="88.3" stroke="black"></line>
                <line th:if="*{g.phase}%2==0" x1="35.1" x2="49.9" y1="71.5" y2="71.5" stroke="black"></line>
                <line th:if="*{g.phase}%2==0" x1="37.65" x2="52.45" y1="78.35" y2="78.35" stroke="black"></line>
                <line th:if="*{g.phase}%2==0" x1="41.4" x2="56.5" y1="134.9" y2="117.35" stroke="black"></line>
                <!--end-->
                <!--ноль без разрывом-->
                <line th:if="*{g.phase}%2!=0" x1="56.5" x2="56.5" y1="117.35" y2="10.35" stroke="black"></line>
                <!--end-->
                <line x1="41.4" x2="56.5" y1="134.9" y2="117.35" stroke="black"></line>

                <!--            PE-->
                <circle r="3" cx="70.55" cy="17.8"/>
                <line x1="70.55" x2="70.55" y1="117.35" y2="17.8" stroke="black"></line>
                <line x1="41.4" x2="70.5" y1="134.9" y2="117.35" stroke="black"></line>

                <!--            обознач фаз 1P-->
                <text th:if="*{g.phase}<=2" x="30" y="40" font-size="50%">L</text>
                <line th:if="*{g.phase}<=2" x1="38" x2="44.95" y1="40.9" y2="33.95" stroke="black"></line>
                <!--            обознач фаз 3P-->
                <text th:if="*{g.phase}>2" x="10" y="40" font-size="50%">А,В,С</text>
                <line th:if="*{g.phase}>2" x1="38" x2="44.95" y1="40.9" y2="33.95" stroke="black"></line>
                <line th:if="*{g.phase}>2" x1="38" x2="44.95" y1="34.6" y2="27.65" stroke="black"></line>
                <line th:if="*{g.phase}>2" x1="38" x2="44.95" y1="47.55" y2="40.6" stroke="black"></line>

                <!--УЗО-->
                <line th:if="*{g.RCDCurrent}!=null" x1="24.2" x2="30.25" y1="77.2" y2="77.2" stroke="black"></line>
                <line th:if="*{g.RCDCurrent}!=null" x1="24.2" x2="24.2" y1="103.15" y2="77.2" stroke="black"></line>
                <line th:if="*{g.RCDCurrent}!=null" x1="24.2" x2="32.65" y1="103.15" y2="103.15" stroke="black"></line>
                <ellipse th:if="*{g.RCDCurrent}!=null" rx="16.4" ry="7.55" cx="48.5" cy="103.15" stroke="black"
                         fill="none" stroke-width="1"/>
                <text th:if="*{g.RCDCurrent}!=null" x="5" y="60" font-size="60%" style="writing-mode: vertical-lr" th:text="*{g.RCDCurrent}+'mA'"></text>
                <!--таблица-->
                <!--        номер группы-->
                <text x="38" y="247" font-size="70%" th:text="*{iter.count}"></text>
                <line x1="0" x2="85.6" y1="233.6" y2="233.6" stroke="black"></line>
                <line x1="0" x2="0" y1="254.3" y2="233.95" stroke="black"></line>
                <line x1="86.4" x2="86.4" y1="254.3" y2="233.95" stroke="black"></line>
                <line x1="0" x2="85.6" y1="254.3" y2="254.3" stroke="black"></line>

                <!--    мощность-->
                <text th:if="*{g.phase}>2" x="33" y="268" font-size="70%" th:text="*{g.ratedCurrent}!=null?*{g.ratedCurrent}*0.38:''"></text>
                <text th:if="*{g.phase}<=2" x="33" y="268" font-size="70%" th:text="*{g.ratedCurrent}!=null?*{g.ratedCurrent}*0.22:''"></text>
                <line x1="0" x2="0" y1="274.65" y2="254.3" stroke="black"></line>
                <line x1="86.4" x2="86.4" y1="274.65" y2="254.3" stroke="black"></line>
                <line x1="0" x2="85.6" y1="274.65" y2="274.65" stroke="black"></line>
                <!--    ток-->
                <text th:if="*{g.ratedCurrent}!=null" x="28" y="290" font-size="70%" th:text="*{g.ratedCurrent}+' / '+*{g.usageRate}"></text>
                <line x1="0" x2="0" y1="295" y2="274.65" stroke="black"></line>
                <line x1="86.4" x2="86.4" y1="295" y2="274.65" stroke="black"></line>
                <line x1="0" x2="85.6" y1="295" y2="295" stroke="black"></line>

                <!--    потребитель-->
<!--                <text x="10" y="320" font-size="80%" th:text="*{g.name}"></text>-->
                <text x="10" y="10" class="consumer d-none" font-size="80%" th:text="*{g.name}"></text>

                <text x="10" y="300" class="res" font-size="80%"></text>

                <!-- <text x="10" y="330" font-size="80%">сеть</text> -->
                <line x1="0" x2="0" y1="370.1" y2="295" stroke="black"></line>
                <line x1="86.4" x2="86.4" y1="370.1" y2="295" stroke="black"></line>
                <line x1="0" x2="85.6" y1="370.1" y2="370.1" stroke="black"></line>
            </svg>

            <!--окончание-->
            <svg height="371.1" width="45" style="margin-left: -5px;">
                <!--        шины шкафа-->
                <text x="23" y="7" font-size="55%">A,B,C</text>
                <text x="23" y="15" font-size="55%">N</text>
                <text x="23" y="23" font-size="55%">PE</text>
                <line x1="0" x2="20" y1="3" y2="3" stroke="black" stroke-width="2"></line>
                <line x1="0" x2="20" y1="10" y2="10" stroke="black"></line>
                <line x1="0" x2="20" y1="17.2" y2="17.2" stroke="black"></line>
            </svg>
        </div>
    </div>
</div>
<script>
    window.onload = function(){
        // add group consumer
        var consumer = document.getElementsByClassName('consumer d-none');
        var res = document.getElementsByClassName('res');
        for (let i =0; i<consumer.length;i++){
            // var textConsumer = consumer[i].textContent.split(' ');
            var textConsumer = [];
            var index = 0;
            var temp ='';
           var a = consumer[i].textContent;
            for (let k=0;k<a.length;k++){
              b = a.substring(k,k+1);
                temp +=  b;
              if (k%10===0 && k!==0){
                  textConsumer[index] = temp+(b!==" "?"-":'');
                  index++;
                  temp = '';
              }
          }
          if (temp!=null){
              textConsumer[index] = temp;
              temp='';
          }
            for (let j =0; j<textConsumer.length;j++){
                var text = document.createElementNS("http://www.w3.org/2000/svg",'tspan');
                text.setAttribute('x','10');
                text.setAttribute('dy','1em');
                // text.setAttribute('font-size','80%');
                text.textContent = textConsumer[j];
                res[i].appendChild(text);
            }
        }
        // add name project
        var building = document.getElementById('building').textContent;
        var buildingResult = document.getElementById('building-result');
        var buildName = '';
        var nameShield = document.getElementById('nameShield').textContent;
        var textBuild = ['Однолинейная схема '+nameShield];
        var iB = 1;
        for (let i = 0;i<building.length;i++){
            s = building.substring(i,i+1);
            buildName += s;
            if (i%30===0 && i!==0){
                textBuild[iB] = buildName+ (s!==" "?"-":'');
                buildName ='';
                iB++;
            }
        }
        if (buildName!=='' || buildName!== null){
            textBuild[iB] = buildName;
        }

        for (let i = 0; i<textBuild.length;i++){
            var t = document.createElementNS("http://www.w3.org/2000/svg",'tspan');
            t.setAttribute('x','850');
            t.setAttribute('dy','1em');
            t.textContent= textBuild[i];
            buildingResult.appendChild(t);
        }

        // window.print();
        print()
    }
    window.onclick = function () {
        window.history.back();
    };
</script>
</body>
</html>